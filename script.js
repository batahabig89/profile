// Profile data embedded directly in JavaScript
const profileData = {
    "personalInfo": {
      "name": "Batbayar Altankhuyag",
      "title": "Software Engineer | Hardware engineer | Robot engineer",
      "email": "batahabig@gmail.com",
      "phone": "+976 85245464",
      "location": ["Sukhbaatar", "Ulaanbaatar", "Mongolia"],
      "vehicleLicense": true,
      "age": 36,
      "profileImage": "https://scontent.fuln2-2.fna.fbcdn.net/v/t39.30808-6/534578045_3994013884246639_5360597488153546510_n.jpg?stp=cp6_dst-jpg_tt6&_nc_cat=103&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=n09_O_KuOVAQ7kNvwEuVRo2&_nc_oc=Adk3kwy-hDrnp09VCPCcmTVQg_0OLOdspM2gVzhNahuAj6U4H50NAV9zFou8w3TYCOs&_nc_zt=23&_nc_ht=scontent.fuln2-2.fna&_nc_gid=8B7LiaWeBztpVegbwh1yDg&oh=00_Afe9ksynHe2PaSxl2y5VcspQ9J5c8nkGaxZPNkowAdYf3w&oe=68EAE67A"
    },
    "summary": {
      "lines": [
        "in Software Development, Web & Mobile & Robot",
        "IOT hardware development",
        "Humanoid robot development",
        "digital products."
      ]
    },
    "platforms": {
      "primary": ["IOS", "Windows", "Linux", "Android"],
      "secondary": ["Web platform", "Mobile platform", "Desktop platform", "IOT platform", "ROSA"]
    },
    "programmingLanguages": [
      "C#, C++",
      "Java, GO, Python, ",
      "JavaScript, Typescript, React, Vue, Kotlin"
    ],
    "workSkills": {
      "frontend": ["React", "Vue.js", "Angular", "HTML5", "CSS3", "JavaScript", "TypeScript"],
      "backend": ["Java", "Go", "Python", "C#" ],
      "database": ["Oracle", "Oracle REST API", "MySQL", "PostgreSQL", "MongoDB", "Redis", "SQLite"],
      "cloud": [ "Docker", "Kubernetes","Azure"],
      "mobile": [ "Android"],
      "devops": ["Git", "CI/CD", "Azure DevOps", "Docker", "Kubernetes", "Linux"]
    },
    "tools": [
      "ReactJS, NodeJS",
      "NextJS, Unity3D",
      "VisualStudio",
      "GitHub, Docker",
      "Figma, Cursor, VSCode, Cursor", 
      "IntelliJ, Android Studio"
    ],
    "spokenLanguages": {
      "English": "Basic",
      "Mongolia": "Native"
    },
    "profileTraits": ["LEADER", "CREATIVE", "AMBITIOUS"],
    "education": [
      {
        "level": "Bachelor's Degree",
        "field": "Hardware engineer",
        "date": "Graduated 2010",
        "institution": "Mongolian University of Science and Technology - Computer Science and Technology",
        "GPA": "2.89"
      },
      {
        "level": "Bachelor's Degree",
        "field": "Software engineer",
        "date": "Graduated 2011",
        "institution": "Mongolian University of Science and Technology - Computer Science and Technology",
        "GPA": "3"
      }
    ],
    "experience": [
      {
        "company": "Nomin Holding LLC",
        "duration": {
          "start": "2025",
          "end": "Present"
        },
        "role": "Staff developer",
        "type": "corporate",
        "description": [
          "solutions company. Providing Web Development"
        ]
      },
      {
        "company": "Egune LLC",
        "duration": {
          "start": "2025-2",
          "end": "20225-9"
        },
        "role": "Robot engineer",
        "type": "Full-time",
        "description": [
          "Developed humanoind robot development"
        ]
      },
      {
          "company": "Simple Fintech",
          "duration": {
            "start": "2022-7",
            "end": "2024-11"
          },
          "role": "Backend developer",
          "type": "Full-time",
          "description": [
            "Developed spring boot microservices"
          ]
      },
      {
          "company": "ITC GOV",
          "duration": {
            "start": "2020-2",
            "end": "2022-7"
          },
          "role": "Fullstack developer",
          "type": "Full-time",
          "description": [
            "Developed spring boot microservices and angular frontend"
          ]
      },
      {
          "company": "CEO",
          "duration": {
            "start": "2017-9",
            "end": "2020-2"
          },
          "role": "Project manager",
          "type": "Full-time",
          "description": [
            "Development and management of the company"
          ]
      },
      {
          "company": "ITZONE LLC",
          "duration": {
            "start": "2014-9",
            "end": "2027-9"
          },
          "role": "Software engineer",
          "type": "Full-time",
          "description": [
            "software automation, hardware automation"
          ]
      },
      {
          "company": "Mongolian university science and technology",
          "duration": {
            "start": "2011-9",
            "end": "2014-9"
          },
          "role": "Robot engineer, teacher",
          "type": "Full-time",
          "description": [
            "Mechatronics engineering"
          ]
      },
      {
          "company": "Micromagic LLC",
          "duration": {
            "start": "2010-9",
            "end": "2011-9"
          },
          "role": "Automation engineer",
          "type": "Full-time",
          "description": [
            "Hardware automation"
          ]
      }
    ],
    "certifications": [
      {
        "name": "Java",
        "issuer": "basic",
        "date": "2010"
      },
      {
        "name": "Microsoft Azure Developer Associate",
        "issuer": "Microsoft",
        "date": "2022"
      }
    ],
    "projects": [
      {
        "name": "ITAX.MTA.GOV.MN",
        "description": "Full-stack Angular frontend and java spring boot microservicesbackend",
        "technologies": ["React", "Typescript", "Oracle", "rest API"],
        "url": "https://itax.mta.gov.mn"
      },
      {
        "name": "ETAX.MTA.GOV.MN",
        "description": "Full-stack React frontend and java microservices backend",
        "technologies": ["React js", "Firebase", "java spring boot"],
        "url": "https://etax.mta.gov.mn"
      },
      {
          "name": "burtgel.gov.mn",
          "description": "Full-stack javascript bootstrap frontend and java monolit backend",
          "technologies": ["javacript jquery", "java spring boot"],
          "url": "https://burtgel.gov.mn"
      },
      {
          "name": "ehalamj.mn",
          "description": "Full-stack javascript bootstrap frontend and  tapestry java monolit backend",
          "technologies": ["javacript jquery", "java spring boot"],
          "url": "https://ehalamj.mn"
      },
      {
          "name": "simple.app",
          "description": "Fintech, backend only java spring boot microservices",
          "technologies": ["flutter mobile", "java spring boot", "react web"],
          "url": "https://simple.mn"
      }
    ]
  };

// Calculate age from birthdate
function calculateAge(birthdate) {
    const today = new Date();
    const birth = new Date(birthdate);
    let age = today.getFullYear() - birth.getFullYear();
    const monthDiff = today.getMonth() - birth.getMonth();
    
    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
        age--;
    }
    
    return age;
}

// Load profile data
function loadProfile() {
    try {
        const data = profileData;
        
        // Calculate age if birthdate exists
        if (data.personalInfo.birthdate) {
            data.personalInfo.age = calculateAge(data.personalInfo.birthdate);
        }
        
        renderProfile(data);
    } catch (error) {
        console.error('Error loading profile data:', error);
        document.getElementById('leftPanel').innerHTML = '<div class="loading">Error loading profile data</div>';
        document.getElementById('rightPanel').innerHTML = '<div class="loading">Error loading profile data</div>';
    }
}

function renderProfile(data) {
    renderLeftPanel(data);
    renderRightPanel(data);
}

function renderLeftPanel(data) {
    const leftPanel = document.getElementById('leftPanel');
    leftPanel.innerHTML = `
        <div class="profile-section">
            <img src="${data.personalInfo.profileImage}" alt="Profile Photo" class="profile-img">
            <div class="username">
                <span class="keyword">public</span> ${data.personalInfo.name}
            </div>
        </div>

        <div class="section">
            <div class="section-content">
                ${data.platforms.primary.join(',<br>')}
            </div>
        </div>

        <div class="section">
            <div class="section-title">enum PLATFORMS</div>
        </div>

        <div class="section">
            <div class="section-content">
                ${data.platforms.secondary.join(',<br>')}
            </div>
        </div>

        <div class="section">
            <div class="section-title">enum LANGUAGES</div>
        </div>

        <div class="section">
            <div class="section-content">
                ${data.programmingLanguages.join('<br>')}
            </div>
        </div>

        <div class="section">
            <div class="section-title">WORK SKILLS</div>
        </div>

        <div class="section">
            <div class="section-content">
            <strong>Frontend:</strong> ${data.workSkills.frontend.join(', ')}<br><br>
            <strong>Backend:</strong> ${data.workSkills.backend.join(', ')}<br><br>
            <strong>Database:</strong> ${data.workSkills.database.join(', ')}<br><br>
            <strong>Cloud:</strong> ${data.workSkills.cloud.join(', ')}<br><br>
            <strong>Mobile:</strong> ${data.workSkills.mobile.join(', ')}<br><br>
            <strong>DevOps:</strong> ${data.workSkills.devops.join(', ')}
        </div>
        </div>

        <div class="section">
            <div class="section-title">TOOLS</div>
        </div>

        <div class="section">
            <div class="section-content">
                ${data.tools.join('<br>')}
            </div>
        </div>

        <div class="section">
            <div class="section-title">LANGUAGES SPOKEN</div>
        </div>

        <div class="section">
            <div class="section-content">
                ${Object.entries(data.spokenLanguages).map(([lang, level]) => `${lang} = ${level}`).join('<br>')}
            </div>
        </div>

        <div class="section">
            <div class="section-title">PROFILE</div>
        </div>

        <div class="section">
            <div class="section-content">
                ${data.profileTraits.join('<br>')}
            </div>
        </div>
    `;
}

function renderRightPanel(data) {
    const rightPanel = document.getElementById('rightPanel');
    
    // Summary section
    const summaryHTML = data.summary.lines.map(line => 
        `<div class="comment">/// ${line}</div>`
    ).join('');

    // Personal information section
    const personalInfoHTML = `
        <div class="code-section">
            <div class="code-line">
                <span class="keyword">public</span> <span class="class-name">INFORMATION</span>
            </div>
            <div class="code-line indent-1">
                <span class="keyword">public string</span> <span class="string">"${data.personalInfo.name}"</span>,
            </div>
            <div class="code-line indent-1">
                <span class="keyword">public string</span> <span class="string">"${data.personalInfo.title}"</span>,
            </div>
            <div class="code-line indent-1">
                <span class="keyword">public</span> <span class="type">email</span> <span class="string">"${data.personalInfo.email}"</span>,
            </div>
            <div class="code-line indent-1">
                <span class="keyword">public</span> <span class="type">PHONE</span> = <span class="string">${data.personalInfo.phone}</span>
            </div>
            <div class="code-line indent-1">
                <span class="keyword">public</span> <span class="type">LOCATION</span> = <span class="operator">[</span><span class="string">'${data.personalInfo.location[0]}'</span>, <span class="string">${data.personalInfo.location[1]}</span><span class="operator">]</span>
            </div>
            <div class="code-line">
                <span class="variable">VEHICLE_LICENSE</span> = <span class="boolean">${data.personalInfo.vehicleLicense}</span>
            </div>
            <div class="code-line">
                <span class="variable">AGE</span> = <span class="number">${data.personalInfo.age}</span>
            </div>
        </div>
    `;

    // Education section
    const educationHTML = `
        <div class="code-section">
            <div class="code-line">
                <span class="keyword">public static class</span> <span class="class-name">EDUCATION</span>
            </div>
            ${data.education.map((edu, index) => `
                <div class="code-line indent-1">
                    <span class="keyword">private void</span> <span class="method">Education${index + 1}</span>()
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">Level</span> = <span class="string">"${edu.level}"</span>,
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">Field</span> = <span class="string">"${edu.field}"</span>,
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">Date</span> = <span class="string">"${edu.date}"</span>,
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">Institution</span> = <span class="string">"${edu.institution}"</span>,
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">GPA</span> = <span class="number">${edu.GPA || 'N/A'}</span>
                </div>
            `).join('')}
        </div>
    `;

    // Experience section
    const experienceHTML = `
        <div class="experience-container">
            <div class="experience-title">Work Experience</div>
            <div class="experience-grid">
                ${data.experience.map(exp => `
                    <div class="experience-card">
                        <div class="experience-card-header">
                            <h3 class="experience-company">${exp.company}</h3>
                            <div class="experience-duration">${exp.duration.start} - ${exp.duration.end}</div>
                            <div class="experience-role">${exp.role}</div>
                        </div>
                        <div class="experience-card-body">
                            <div class="experience-type">${exp.type}</div>
                            <p class="experience-description">${exp.description.join(' ')}</p>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;

    // Certifications section
    const certificationsHTML = data.certifications ? `
        <div class="code-section">
            <div class="code-line">
                <span class="keyword">public static class</span> <span class="class-name">CERTIFICATIONS</span>
            </div>
            ${data.certifications.map(cert => `
                <div class="code-line indent-1">
                    <span class="keyword">public void</span> <span class="method">${cert.name.replace(/\s+/g, '')}</span>
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">Issuer</span> = <span class="string">"${cert.issuer}"</span>,
                </div>
                <div class="code-line indent-2">
                    <span class="variable">var</span> <span class="variable">Date</span> = <span class="string">"${cert.date}"</span>
                </div>
            `).join('')}
        </div>
    ` : '';

    // Projects section
    const getProjectIcon = (project) => {
        // Use custom icon from JSON if available, otherwise fallback to auto-detection
        if (project.icon) {
            return project.icon;
        }
        
        // Fallback to automatic emoji detection
        const name = project.name.toLowerCase();
        if (name.includes('tax') || name.includes('gov')) return 'üèõÔ∏è';
        if (name.includes('simple') || name.includes('fintech')) return 'üí∞';
        if (name.includes('burtgel') || name.includes('ehalamj')) return 'üìã';
        if (name.includes('app') || name.includes('mobile')) return 'üì±';
        if (name.includes('web') || name.includes('frontend')) return 'üåê';
        if (name.includes('backend') || name.includes('api')) return '‚öôÔ∏è';
        return 'üíª';
    };

    const projectsHTML = data.projects ? `
        <div class="projects-container">
            <div class="projects-title">PROJECTS</div>
            <div class="projects-grid">
                ${data.projects.map(project => `
                    <div class="project-card" onclick="window.open('${project.url}', '_blank')">
                        <div class="project-card-header">
                            <h3 class="project-name">
                                <span class="project-emoji">${getProjectIcon(project)}</span>
                                ${project.name}
                            </h3>
                            <a href="${project.url}" target="_blank" class="project-url">üîó Visit Project</a>
                        </div>
                        <div class="project-card-body">
                            <p class="project-description">${project.description}</p>
                            <div class="project-technologies">
                                ${project.technologies.map(tech => `
                                    <span class="tech-tag">${tech}</span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    ` : '';

    rightPanel.innerHTML = `
        <div class="comment">/// &lt;summary&gt;</div>
        ${summaryHTML}

        ${personalInfoHTML}
        ${educationHTML}
        ${certificationsHTML}
        ${experienceHTML}
        ${projectsHTML}
    `;
}

// Robot eye tracking functionality
function initRobotEyeTracking() {
    // Wait a bit for DOM to be fully loaded
    setTimeout(() => {
        const robotContainer = document.getElementById('robotContainer');
        const leftEye = document.querySelector('.left-eye');
        const rightEye = document.querySelector('.right-eye');
        const leftPupil = document.querySelector('.left-eye .robot-pupil');
        const rightPupil = document.querySelector('.right-eye .robot-pupil');
        
        console.log('Robot elements found:', {
            robotContainer: !!robotContainer,
            leftEye: !!leftEye,
            rightEye: !!rightEye,
            leftPupil: !!leftPupil,
            rightPupil: !!rightPupil
        });
        
        if (!robotContainer || !leftEye || !rightEye || !leftPupil || !rightPupil) {
            console.log('Robot elements not found, retrying...');
            setTimeout(initRobotEyeTracking, 1000);
            return;
        }
        
        let isTracking = false;
        let blinkTimeout;
        
        // Get robot position
        function getRobotPosition() {
            const rect = robotContainer.getBoundingClientRect();
            return {
                x: rect.left + rect.width / 2,
                y: rect.top + rect.height / 2
            };
        }
        
        // Calculate eye movement based on mouse position
        function updateEyePosition(mouseX, mouseY) {
            const robotPos = getRobotPosition();
            const deltaX = mouseX - robotPos.x;
            const deltaY = mouseY - robotPos.y;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            // Limit eye movement range
            const maxDistance = 300;
            const limitedDistance = Math.min(distance, maxDistance);
            const ratio = limitedDistance / maxDistance;
            
            // Calculate eye movement (limited to eye boundaries)
            const eyeMoveX = distance > 0 ? (deltaX / distance) * ratio * 4 : 0; // Max 4px movement
            const eyeMoveY = distance > 0 ? (deltaY / distance) * ratio * 3 : 0; // Max 3px movement
            
            // Apply movement to pupils
            leftPupil.style.transform = `translate(calc(-50% + ${eyeMoveX}px), calc(-50% + ${eyeMoveY}px))`;
            rightPupil.style.transform = `translate(calc(-50% + ${eyeMoveX}px), calc(-50% + ${eyeMoveY}px))`;
            
            // Calculate arm movement based on mouse position
            updateArmPosition(mouseX, mouseY, robotPos);
            
            console.log('Eye tracking:', { mouseX, mouseY, robotPos, deltaX, deltaY, eyeMoveX, eyeMoveY });
        }
        
        // Calculate arm movement based on mouse position
        function updateArmPosition(mouseX, mouseY, robotPos) {
            const leftArm = document.querySelector('.left-arm');
            const rightArm = document.querySelector('.right-arm');
            
            console.log('Arm elements found:', { leftArm: !!leftArm, rightArm: !!rightArm });
            
            if (!leftArm || !rightArm) return;
            
            const deltaX = mouseX - robotPos.x;
            const deltaY = mouseY - robotPos.y;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            if (distance > 0) {
                // Calculate angle for arm pointing (more direct pointing)
                const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);
                
                // Convert angle to arm rotation - arms can point upward and downward
                // Left arm points more directly at mouse (can rotate upward)
                const leftArmAngle = Math.max(-120, Math.min(120, angle - 45));
                // Right arm points more directly at mouse (can rotate upward)
                const rightArmAngle = Math.max(-120, Math.min(120, angle - 135));
                
                // Apply rotation to arms with smooth transition
                leftArm.style.transform = `rotate(${leftArmAngle}deg)`;
                rightArm.style.transform = `rotate(${rightArmAngle}deg)`;
                
                console.log('Arm tracking applied:', { 
                    angle, 
                    leftArmAngle, 
                    rightArmAngle, 
                    deltaX, 
                    deltaY,
                    leftArmTransform: leftArm.style.transform,
                    rightArmTransform: rightArm.style.transform
                });
            }
        }
        
        // Blink animation
        function blink() {
            leftEye.classList.add('tracking');
            rightEye.classList.add('tracking');
            
            setTimeout(() => {
                leftEye.classList.remove('tracking');
                rightEye.classList.remove('tracking');
            }, 300);
        }
        
        // Mouse move event
        document.addEventListener('mousemove', (e) => {
            if (!isTracking) {
                isTracking = true;
                console.log('Started tracking mouse');
                // Random blink when starting to track
                if (Math.random() < 0.3) {
                    setTimeout(blink, 500);
                }
            }
            
            updateEyePosition(e.clientX, e.clientY);
            
            // Clear existing blink timeout
            clearTimeout(blinkTimeout);
            
            // Random blink during tracking
            if (Math.random() < 0.001) { // Very low probability for natural blinking
                blinkTimeout = setTimeout(blink, Math.random() * 2000);
            }
        });
        
        // Continuous arm tracking - arms always point to mouse even when not moving
        let lastMouseX = 0;
        let lastMouseY = 0;
        
        // Track mouse position continuously
        document.addEventListener('mousemove', (e) => {
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
        });
        
        // Update arms every 100ms to ensure they always point to mouse
        setInterval(() => {
            if (lastMouseX !== 0 || lastMouseY !== 0) {
                const robotPos = getRobotPosition();
                updateArmPosition(lastMouseX, lastMouseY, robotPos);
            }
        }, 100);
        
        // Mouse leave event - reset eyes and arms to center
        document.addEventListener('mouseleave', () => {
            isTracking = false;
            console.log('Stopped tracking mouse');
            leftPupil.style.transform = 'translate(-50%, -50%)';
            rightPupil.style.transform = 'translate(-50%, -50%)';
            
            // Reset arms to default position
            const leftArm = document.querySelector('.left-arm');
            const rightArm = document.querySelector('.right-arm');
            if (leftArm && rightArm) {
                leftArm.style.transform = 'rotate(0deg)';
                rightArm.style.transform = 'rotate(0deg)';
            }
        });
        
        // Periodic blink when not tracking
        setInterval(() => {
            if (!isTracking && Math.random() < 0.1) {
                blink();
            }
        }, 3000);
        
        console.log('Robot eye tracking initialized successfully');
    }, 500);
}

// Rocket effect functionality
function initRocketEffect() {
    const rocketContainer = document.getElementById('rocketContainer');
    
    if (!rocketContainer) return;
    
    // Click event listener for rocket launch
    document.addEventListener('click', (e) => {
        // Don't launch rocket if clicking on robot
        if (e.target.closest('.robot-container')) return;
        
        launchRocket(e.clientX, e.clientY);
    });
    
    function launchRocket(targetX, targetY) {
        const robotContainer = document.getElementById('robotContainer');
        if (!robotContainer) return;
        
        // Get robot position
        const robotRect = robotContainer.getBoundingClientRect();
        const robotX = robotRect.left + robotRect.width / 2;
        const robotY = robotRect.top + robotRect.height / 2;
        
        // Create rocket element with emoji
        const rocket = document.createElement('div');
        rocket.className = 'rocket';
        rocket.innerHTML = 'üöÄ';
        rocket.style.left = robotX + 'px';
        rocket.style.top = robotY + 'px';
        
        // Create enhanced smoke trail
        const trail = document.createElement('div');
        trail.className = 'rocket-trail';
        trail.style.left = (robotX - 2) + 'px';
        trail.style.top = (robotY + 20) + 'px';
        
        // Add to container
        rocketContainer.appendChild(rocket);
        rocketContainer.appendChild(trail);
        
        
        // Calculate rocket path (always point downward, mirrored left)
        const deltaX = targetX - robotX;
        const deltaY = targetY - robotY;
        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
        const angle = 90; // Always point downward (bottom side)
        
        // Set rocket rotation
        rocket.style.transform = `rotate(${angle}deg)`;
        trail.style.transform = `rotate(${angle}deg)`;
        
        // Animate rocket movement
        const animationDuration = 1000; // 1 second
        const startTime = Date.now();
        
        function animateRocket() {
            const elapsed = Date.now() - startTime;
            const progress = Math.min(elapsed / animationDuration, 1);
            
            // Easing function for smooth movement
            const easeOut = 1 - Math.pow(1 - progress, 3);
            
            const currentX = robotX + (deltaX * easeOut);
            const currentY = robotY + (deltaY * easeOut);
            
            // Calculate stable flight pointing downward with 180 degree rotation
            const downwardAngle = 90; // Always point downward (bottom side)
            const rotation180 = 180; // Additional 180 degree rotation
            const wobbleX = Math.sin(progress * Math.PI * 4) * 2; // Reduced wobble
            const wobbleY = Math.cos(progress * Math.PI * 3) * 1;
            
            // Apply transformations with 180 degree rotation
            rocket.style.left = (currentX + wobbleX) + 'px';
            rocket.style.top = (currentY + wobbleY) + 'px';
            rocket.style.transform = `rotate(${downwardAngle + rotation180}deg)`;
            
            trail.style.left = (currentX + 30 + wobbleX) + 'px';
            trail.style.top = (currentY + 25 + wobbleY) + 'px';
            trail.style.transform = `rotate(${downwardAngle + rotation180}deg)`;
            
            if (progress < 1) {
                requestAnimationFrame(animateRocket);
            } else {
                // Remove rocket and trail (no explosion)
                setTimeout(() => {
                    if (rocket.parentNode) rocket.parentNode.removeChild(rocket);
                    if (trail.parentNode) trail.parentNode.removeChild(trail);
                }, 100);
            }
        }
        
        requestAnimationFrame(animateRocket);
    }
    
    function createExplosion(x, y) {
        const explosion = document.createElement('div');
        explosion.className = 'rocket-explosion';
        explosion.style.left = x + 'px';
        explosion.style.top = y + 'px';
        
        rocketContainer.appendChild(explosion);
        
        // Remove explosion after animation
        setTimeout(() => {
            if (explosion.parentNode) explosion.parentNode.removeChild(explosion);
        }, 600);
    }
}

// Load profile when page loads
document.addEventListener('DOMContentLoaded', () => {
    loadProfile();
    initRobotEyeTracking();
    initRocketEffect();
});
